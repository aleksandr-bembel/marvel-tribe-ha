# –ü—Ä–∏–º–µ—Ä—ã —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–ª—è Marvel Tribe
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –Ω—É–∂–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –≤ –≤–∞—à —Ñ–∞–π–ª scripts.yaml

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
refresh_device_data:
  alias: "Marvel Tribe - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö"
  description: "–û–±–Ω–æ–≤–ª—è–µ—Ç –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
  sequence:
    - service: button.press
      entity_id: button.marvel_tribe_refresh_data
    - delay: "00:00:05"
    - service: notify.persistent_notification
      data:
        message: "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö Marvel Tribe –∑–∞–≤–µ—Ä—à–µ–Ω–æ"
        title: "Marvel Tribe"

# –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
device_diagnostics:
  alias: "Marvel Tribe - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
  description: "–í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
  sequence:
    - service: notify.persistent_notification
      data:
        message: "–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Marvel Tribe..."
        title: "Marvel Tribe - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞"
    
    # –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
    - condition: state
      entity_id: binary_sensor.marvel_tribe_connected
      state: "on"
    
    # –ü–∏–Ω–≥ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
    - service: button.press
      entity_id: button.marvel_tribe_ping_device
    
    - delay: "00:00:02"
    
    # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º –≤—Ä–µ–º—è
    - service: button.press
      entity_id: button.marvel_tribe_sync_time
    
    - delay: "00:00:03"
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
    - service: button.press
      entity_id: button.marvel_tribe_refresh_data
    
    - delay: "00:00:05"
    
    # –£–≤–µ–¥–æ–º–ª—è–µ–º –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
    - service: notify.persistent_notification
      data:
        message: |
          –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞!
          
          –°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: {{ states('binary_sensor.marvel_tribe_connected') }}
          –°—Ç–∞—Ç—É—Å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è: {{ states('sensor.marvel_tribe_connection_status') }}
          –ë–∞—Ç–∞—Ä–µ—è: {{ states('sensor.marvel_tribe_battery_level') }}%
          –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ: {{ states('sensor.marvel_tribe_battery_voltage') }}V
          –ó–∞—Ä—è–¥–∫–∞: {{ states('binary_sensor.marvel_tribe_charging') }}
          –í—Ä–µ–º—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞: {{ states('sensor.marvel_tribe_device_time') }}
          –ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: {{ states('switch.marvel_tribe_auto_sync_time') }}
        title: "Marvel Tribe - –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞"

# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π –≤—Ä–µ–º–µ–Ω–∏
enable_auto_sync:
  alias: "Marvel Tribe - –í–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é"
  description: "–í–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏"
  sequence:
    - service: switch.turn_on
      entity_id: switch.marvel_tribe_auto_sync_time
    - service: notify.persistent_notification
      data:
        message: "–ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤–∫–ª—é—á–µ–Ω–∞ ‚è∞"
        title: "Marvel Tribe"

disable_auto_sync:
  alias: "Marvel Tribe - –í—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é"
  description: "–í—ã–∫–ª—é—á–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏"
  sequence:
    - service: switch.turn_off
      entity_id: switch.marvel_tribe_auto_sync_time
    - service: notify.persistent_notification
      data:
        message: "–ê–≤—Ç–æ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–∫–ª—é—á–µ–Ω–∞"
        title: "Marvel Tribe"

manual_sync:
  alias: "Marvel Tribe - –†—É—á–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è"
  description: "–í—ã–ø–æ–ª–Ω—è–µ—Ç —Ä—É—á–Ω—É—é —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä–µ–º–µ–Ω–∏"
  sequence:
    - service: button.press
      entity_id: button.marvel_tribe_sync_time
    - delay: "00:00:03"
    - service: notify.persistent_notification
      data:
        message: "–í—Ä–µ–º—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –≤—Ä—É—á–Ω—É—é üïê"
        title: "Marvel Tribe"

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –±–∞—Ç–∞—Ä–µ–∏
battery_status_check:
  alias: "Marvel Tribe - –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞—Ç–∞—Ä–µ–∏"
  description: "–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏ –∏ —É–≤–µ–¥–æ–º–ª—è–µ—Ç"
  sequence:
    - service: notify.persistent_notification
      data:
        message: |
          –°–æ—Å—Ç–æ—è–Ω–∏–µ –±–∞—Ç–∞—Ä–µ–∏ Marvel Tribe:
          –£—Ä–æ–≤–µ–Ω—å: {{ states('sensor.marvel_tribe_battery_level') }}%
          –ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ: {{ states('sensor.marvel_tribe_battery_voltage') }}V
          –ó–∞—Ä—è–¥–∫–∞: {{ '–î–∞' if is_state('binary_sensor.marvel_tribe_charging', 'on') else '–ù–µ—Ç' }}
        title: "Marvel Tribe - –ë–∞—Ç–∞—Ä–µ—è"

# –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
setup_device:
  alias: "Marvel Tribe - –ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞"
  description: "–í—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª–Ω—É—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞"
  sequence:
    - service: switch.turn_on
      entity_id: switch.marvel_tribe_auto_sync_time
    - service: button.press
      entity_id: button.marvel_tribe_sync_time
    - delay: "00:00:03"
    - service: button.press
      entity_id: button.marvel_tribe_refresh_data
    - delay: "00:00:05"
    - service: notify.persistent_notification
      data:
        message: "–ü–æ–ª–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞! ‚úÖ"
        title: "Marvel Tribe"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
connection_test:
  alias: "Marvel Tribe - –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"
  description: "–¢–µ—Å—Ç–∏—Ä—É–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ–º"
  sequence:
    - service: button.press
      entity_id: button.marvel_tribe_ping_device
    - delay: "00:00:02"
    - service: notify.persistent_notification
      data:
        message: |
          –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω:
          –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ: {{ '–ê–∫—Ç–∏–≤–Ω–æ' if is_state('binary_sensor.marvel_tribe_connected', 'on') else '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' }}
          –°—Ç–∞—Ç—É—Å: {{ states('sensor.marvel_tribe_connection_status') }}
          –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: {{ states('sensor.marvel_tribe_last_update') }}
        title: "Marvel Tribe - –¢–µ—Å—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"
